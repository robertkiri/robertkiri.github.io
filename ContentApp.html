<html>

<body>
  <style> 
    input[type=text] {
      width: 100%;
      padding: 12px 20px;
      margin: 8px 0;
      box-sizing: border-box;
      border: 2px solid red;
      border-radius: 4px;
    }
  </style>

<title>ContentApp</title>  
<h1 id="name">ContentApp</h1> 
<br>

<label>Message received:</label>
<label id="received"></label>
<br>
<label>Message to send:</label>
<input type="text" id="message"></html>
<button id="button">Send message</button>

<br>
<br>
<button id="button" onclick="openwindow()">Open window</button>

<script src="https://appsforoffice.microsoft.com/lib/1/hosted/office.js" type="text/javascript"></script>

<script>

    const channel = new BroadcastChannel("example-channel");
    const messageControl = document.querySelector("#message");
    const button = document.querySelector("#button");
    const received = document.querySelector("#received");
    const name = document.querySelector("#name");
    
    button.addEventListener("click", () => {
        console.log("sent item");
        channel.postMessage(messageControl.value);
    });
    
    channel.addEventListener("message", (event) => {
      console.log("received");
      received.textContent = event.data;
    });

    function openwindow(){
      window.open("https://robertkiri.github.io/TaskPaneApp.html","","width=200,height=200");
    }

    Office.onReady(function(info) {
      let date = new Date();
      //name.textContent = "ConsoleApp loaded: " + date;
    });
    </script>
</body>
</html>